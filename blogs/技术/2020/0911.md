---
title: 0.1 + 0.2 !== 0.3
date: 2020-09-11
tags:
    - JavaScript
categories:
    - 技术
---

## IEEE 754 计算步骤

1. 指数对阶
    1. 小阶对大阶，会右移，容易丢失位数
    2. 相加或相减，值可以溢出
2. 尾数运算
    1. 尾数运算就是在完成对阶以后进行尾数相加减
3. 结果规格化
    1. 左移规格化，右移可能精度丢失
4. 舍入处理
    1. 四舍五入，1 入 0 舍（默认）
    2. 朝正无穷方向舍入
    3. 朝负无穷方向舍入
    4. 朝 0 方向舍入
5. 溢出检查
    1. 运算结果的阶码的值判断是否溢出
    2. 超过最大正数（上溢）：浮点数正数是正上溢，否则是负上溢

## 双精度 64 举例

1. 符号位（1 位）+ 指数位（11 位）+ 尾数（52 位）
2. 符号位中，1 表示负数，0 表示正数
3. 指数位中，指数 = 指数 + 1023（偏移码）
4. 尾数中，默认存储 1 后面部分，小数部分

## 0.1 + 0.2 !== 0.3

1. js 采用的是 IEEE 754 标准，其中有俩个标准一种是 64 位双精度浮点数，一种是 32 为单精度浮点数
   这俩种标准主要的区别在于数的范围的大小
2. 32 位的尾数一共 23 个字符。最多表示 23 个 1 也就是数字 2^23(8388608)。当值大于这个数的时候就会超过 23 位
   因此就没法计算了。（64 位也是相同的道理）
3. 在计算的时候并不是先将 10 进制数计算完成在存储为 2 进制。而是会先将 10 进制转换为二进制在计算
4. 0.1 或 0.2 在转换二进制数时是个无限循环小数，会出现小数丢失情况，所以 0.1 + 0.2 !== 0.3

::: tip
作者：chenjie <br>
链接：https://webchenjie.cn <br>
来源：ChenJieBlog
:::
