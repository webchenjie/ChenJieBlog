---
title: HTML5 data-* 自定义属性
date: 2020-07-20
tags:
  - HTML
categories:
  - 技术
---

## 前言

在 jQuery 的 attr 与 prop 提到过在 IE9 之前版本中如果使用 property 不当会造成内存泄露问题，而且关于 Attribute 和 Property 的区别也让人十分头痛，在 HTML5 中添加了 data-*的方式来自定义属性，所谓 data-*实际上上就是 data-前缀加上自定义的属性名，使用这样的结构可以进行数据存放。使用 data-\*可以解决自定义属性混乱无管理的现状。

## 读写方式

data-\*有两种设置方式，可以直接在 HTML 元素标签上书写

```js
<div id="test" data-age="24">
  Click Here
</div>
```

其中的 data-age 就是一种自定义属性，当然我们也可以通过 JavaScript 来对其进行操作，HTML5 中元素都会有一个 dataset 的属性，这是一个 DOMStringMap 类型的键值对集合

```js
var test = document.getElementById('test')
test.dataset.my = 'Byron'
```

这样就为 div 添加了一个 data-my 的自定义属性，使用 JavaScript 操作 dataset 有两个需要注意的地方

1. 我们在添加或读取属性的时候需要去掉前缀 data-\*，像上面的例子我们没有使用 test.dataset.data-my = 'Byron';的形式。

2. 如果属性名称中还包含连字符(-)，需要转成驼峰命名方式，但如果在 CSS 中使用选择器，我们需要使用连字符格式

为刚才代码追加写内容

```js
<style type="text/css">
  [data-birth-date]
  {
      background-color: #0f0;
      width:100px;
      margin:20px;
  }
</style>
```

```js
test.dataset.birthDate = '19890615'
```

这样我们通过 JavaScript 设置了 data-birth-date 自定义属性，在 CSS 样式表为 div 添加了一些样式，看看效果

![HTML](https://vkceyugu.cdn.bspapp.com/VKCEYUGU-0649cea2-eb34-44bc-b1a4-315b89ff0f52/395a8ad7-e6b4-45ae-bc4e-2e8204bf7a7a.png)
![HTML](https://vkceyugu.cdn.bspapp.com/VKCEYUGU-0649cea2-eb34-44bc-b1a4-315b89ff0f52/e8fd8618-31be-4c4b-978d-d1fbf73e9b92.png)

读取的时候也是通过 dataset 对象，使用”.”来获取属性，同样需要去掉 data-前缀，连字符需要转化为驼峰命名

```js
var test = document.getElementById('test')
test.dataset.my = 'Byron'
test.dataset.birthDate = '19890615'
test.onclick = function () {
  alert(this.dataset.my + ' ' + this.dataset.age + ' ' + this.dataset.birthDate)
}
```

![HTML](https://vkceyugu.cdn.bspapp.com/VKCEYUGU-0649cea2-eb34-44bc-b1a4-315b89ff0f52/fd81a2fa-2710-463a-8272-8d138ff0fab9.png)

## getAttribute/setAttribute

有些同学可能会问这和 getAttribute/setAttribute 除了命名有什么区别吗，我们来看一下

```js
var test = document.getElementById('test')
test.dataset.birthDate = '19890615'
test.setAttribute('age', 25)
test.setAttribute('data-sex', 'male')

console.log(test.getAttribute('data-age')) //24
console.log(test.getAttribute('data-birth-date')) //19890516
console.log(test.dataset.age) //24
console.log(test.dataset.sex) //male
```

![HTML](https://vkceyugu.cdn.bspapp.com/VKCEYUGU-0649cea2-eb34-44bc-b1a4-315b89ff0f52/ba11e1d3-2cab-444c-92f7-028bc8bdf0ac.png)
![HTML](https://vkceyugu.cdn.bspapp.com/VKCEYUGU-0649cea2-eb34-44bc-b1a4-315b89ff0f52/cf37e1d7-0f22-4ab0-8bb1-7001ea45b42b.png)

这样我们可以看出，两者都把属性设置到了 attribute 上（废话，要不人家能叫自定义属性），也就是说 getAttribute/setAttribute 可以操作所有的 dataset 内容，dataset 内容只是 attribute 的一个子集，特殊就特殊在命名上了，但是 dataset 内只有带有 data-前缀的属性（没有 age=25 那个）。

那么为什么我们还要用 data-\*呢，一个最大的好处是我们可以把所有自定义属性在 dataset 对象中统一管理，遍历啊神马的都哦很方便，而不至于零零散散了，所以用用还是不错的。

## 浏览器兼容性

比较不好的消息就是 data-\*的浏览器兼容性情况十分不乐观

```js
Internet Explorer 11+
Chrome 8+
Firefox 6.0+
Opera 11.10+
Safari 6+
```

其中 IE11+简直就是亮瞎小伙伴的眼，看来要想全面使用此属性路漫漫其修远矣

::: tip
作者：谦行 <br>
链接：https://www.cnblogs.com/dolphinx/p/3348458.html <br>
来源：博客园
:::
