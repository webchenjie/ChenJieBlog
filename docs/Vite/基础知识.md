---
title: 基础知识
date: 2022-02-09
---

```js
// 什么是 Vite？
1. 高阶构建工具的封装，基于 Rollup
2. 优点
  1. 使用简单
  2. 快
  3. 便于扩展
----------------------------------------------------------------------------------------------
// 和传统构建工具的区别
1. Vite 具有 High Level API，而 Webpack 或 Rollup 具有 low Level API
2. Vite 不包含自己的编译能力，编译能力基于 Rollup
3. 完全基于 ESM 加载方式的开发
4. Webpack 更全面，Rollup 更专一，Vite 更好用
5. Vite 是为项目而生的，不是为构建而生的
6. 减少了很多配置量（都已经集成）
  1. devServer
  2. 各类 loader
  3. build 命令
----------------------------------------------------------------------------------------------
// Vite 的优势
1. 上手非常简单
2. 开发效率极高
3. 社区成本低（兼容 Rollup 插件）
4. 没有复杂晦涩的配置
5. Vite 有自身的插件系统
6. 生态兼容 Rollup 插件
----------------------------------------------------------------------------------------------
// 为什么 Vite 速度快？
1. 传统的构建工具的编译顺序是从 entry 开始把所有的文件打包成一个 Bundle，当文件越多时就会越慢
2. Vite 在启动时只会做一些预编译，即只编译需要用到的文件，没有用到的文件不会去编译，从而提高速度
3. Vite 的入口是 html 文件中引入的 script 脚本，从这个脚本加载开始分析里面需要编译的文件
4. 使用了 Esbuild 编译工具，这个工具比传统的构建工具的编译速度要快很多
----------------------------------------------------------------------------------------------
// Vite 创建项目
1. 运行命令：npm init @vitejs/app
2. 可以选择框架如，Vue、React 等，现 Vue 版本使用的是 Vue3
3. 没有提供 ESlint、prettire 等功能，只有基础的目录结构
4. Vite 创建的项目不支持保存一个文件自动做 ESlint 校验，只能手动执行 ESlint 命令
5. Webpack 或 Rollup 的编译入口是一个 js 文件，而 Vite 编译入口是一个 html 文件
   通过执行 html 文件中引入的 script 脚本，这个请求会走到 Vite 的 Server 上
   Vite 再去加载对应的 js 文件进行解析
6. 在安装 Vite 的依赖使用需要使用 yarn 安装，使用 npm 安装可能会报错，具体可查看官网的 issues
7. Vite 创建的项目如果是 Vue 项目，默认是支持 .vue 文件的，原因是使用了 '@vitejs/plugin-vue'
   如果想使用 jsx 语法，需要使用 '@vitejs/plugin-vue-jsx'
   // vite.config.js
   import { defineConfig } from 'vite'
   import vue from '@vitejs/plugin-vue'
   import vueJsx from '@vitejs/plugin-vue-jsx'
   export default defineConfig({
     plugins: [vue(), vueJsx()]
   })
8. Vite 构建 Vue2 项目
  1. 因为 Vite 创建的 Vue 项目是 Vue3 版本而没有 Vue2 版本
  2. 如果需要使用 Vite 创建 Vue2 项目需要使用 'underfin/vite-plugin-vue2'
     在执行 npm init @vitejs/app 后选择 vanilla，然后安装上述的依赖和 Vue2
     自己添加 App.vue 和 main.js
  3. 如果觉得手动安装和添加不方便也可以使用 Vite 官方推荐的 'awesome-vite'
     在 'awesome-vite' 下有一个 vite-vue2-starter 的 Vue2 项目模板，可以进行 clone
9. Vite 构建 React 项目
  1. 在 19 年底 React 官方在主推 'FastRefresh' 用于替代 Webpack 的 'react-hot-loader'
    1. 解决很多 rhl 无法解决的问题
    2. 速度更快
    3. 支持局部更新
  2. 所以 React 插件名称在 Vite 中叫 '@vitejs/plugin-react-refresh'
  3. 在执行 npm init @vitejs/app 后选择 react
     在创建的项目的 vite.config.js 中就使用了 '@vitejs/plugin-react-refresh' 插件
  4. 在 html 文件里面的 script 脚本会引入 main.jsx 文件，这里要注意，虽然引入的路径后缀是 jsx
     但是 Vite 真正返回的是编译后的文件，而不是直接把 jsx 文件返回，作为浏览器来说并不会关心是
     引入什么路径后缀，只会关心返回的格式是不是标准的，符合 js 的内容，所以 Vite 并不是直接返回 jsx

```
