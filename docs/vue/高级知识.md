---
title: 高级知识
date: 2021-05-07
---

```js
// vue3 新特性
1. <div :[name]="msg" @[event]="handleEvent"></div> // 动态属性 key 和 val，都是 data 内定义的内容
2. 子组件通过 $attrs 可以获取到父组件传递过来的属性，在非 props 特性中常用到 // 非 props 特性看基础知识
3. 可以直接给子组件上写 'class'，对应的样式会生效
4. 如何改变引用类型的数据内容？
  1. 数组
    1. 使用数组自带的方法，如：push、pop、shift、unshift
    2. 改变数组引用，即使用新数组
    3. 直接更新指定数组的内容，如：this.arr[1] = 'chenj' // 在 vue2.x 中需使用 $set，不可直接改变
  2. 对象
    1. 改变对象引用，即使用新对象
    2. 直接新增对象内容，如：this.obj.name = 'chenj' // 在 vue2.x 中需使用 $set，不可直接新增
5. 绑定多个事件：<button @click="handleClick1(), handleClick2()">按钮</button>
6. 修饰符
  1. 事件修饰符：stop、prevent、capture、self、once、passive  
  2. 按键修饰符：enter、tab、delete、esc、up、down、left、right // 键盘按了对应的按键才会触发
  3. 鼠标修饰符：left、middle、right // 对应鼠标按键
  4. 精确修饰符：exact // 只有按下对应的按键且没有按其他的按键才会触发
7. v-modle
  1. 在 radio 中对应多个选项，每个都需要绑定同一个数据，且 value 是不一样的，绑定的数据是基础类型，如字符串
  2. 在 checkbox 中对应多个选项，每个都需要绑定同一个数据，且 value 是不一样的，绑定的数据的引用类型，如数组
  3. 在 checkbox 中对应单个选项，即表示是否勾选时，默认勾选时 true，不勾选是 false，可以通过 true-value 和 false-value 改变默认值
    <input type="checkbox" v-model="msg" true-value="yes" false-value="no" />
8. 父子组件传值
  1. 通过 v-bind 传递父组件的参数
    <erzi v-bind="params"></erzi> // params = { a: 1, b: 2, c: 3}，相当于传递了一个对象
    在子组件的 props 中接收 a、b、c
  2. 父组件传递参数时使用 id-num 语法，子组件接收使用 idNum 语法，一个使用 -，一个使用大写
  3. 非 props 特性
    1. 在子组件中使用 inheritAttrs: false，表示不接收父组件传递过来的属性，即不会在 html 标签上展示对应的属性
    2. 在子组件中使用 <div v-bind="$attrs"></div> 表示将父组件传递过来的所有属性都放在 div 这个标签上
    3. 在子组件中使用 $attrs 可以获取到父组件传递过来的属性
9. 在子组件中使用 emits: ['event1'] 表示这个组件向外触发了一个事件名是 event1 的事件，如果触发的事件名和定义的不一致会报警告
   也可以使用对象形式，可以对触发事件的参数做校验，如果不符合会报警告
   emits: {
    event1: agrs => {
       if (agrs < 0) { 
         return false 
       }
       return true
      }
   }
10. 实现 v-model
  // 父组件
  const app = Vue.createApp({
    data() {
      return {
        count: 1
      }
    },
    template: '<counter v-model="count" />'
  })
  // 子组件
  app.component('counter', {
    props: ['modelValue'], // 必须使用 modelValue
    methods: {
      handleClick() {
        this.$emit('update:modelValue', this.modelValue + 1)
      }
    },
    template: '<div @click="handleClick">{{ modelValue }}<div/>'
  })
11. 多个 v-model
  // 父组件
  const app = Vue.createApp({
    data() {
      return {
        count1: 1,
        count2: 2
      }
    },
    template: '<counter v-model:count1="count1" v-model:count2="count2" />'
  })
  // 子组件
  app.component('counter', {
    props: ['count1', 'count2'],
    methods: {
      handleClick1() {
        this.$emit('update:count1', this.count1 + 1)
      },
      handleClick2() {
        this.$emit('update:count2', this.count2 + 1)
      }
    },
    template: `
      <div @click="handleClick1">{{ count1 }}<div/>
      <div @click="handleClick2">{{ count2 }}<div/>
    `
  })
12. v-modle 自定义修饰符
  // 父组件
  const app = Vue.createApp({
    data() {
      return {
        count: 'a'
      }
    },
    template: '<counter v-model.uppercase="count" />'
  })
  // 子组件
  app.component('counter', {
    props: {
      modelValue: String,
      modelModifiers: { // 接收自定义修饰符
        default() {
          return {}
        }
      }
    }
    mounted() {
      console.log(this.modelModifiers) // uppercase
    },
    methods: {
      handleClick() {
        let newValue = this.modelValue + 'a'
        if (this.modelModifiers.uppercase) {
          newValue = newValue.toUpperCase()
        }
        this.$emit('update:modelValue', newValue)
      }
    },
    template: '<div @click="handleClick">{{ modelValue }}<div/>'
  })
13. 异步组件
  // 父组件
  const app = Vue.createApp({
    template: '<async-component />'
  })
  // 子组件
  app.component('async-component', Vue.defineAsyncComponent(() => {
    return new Promise((resolve, reject) => {
      setTimeout(() => {
        resolve({
          template: '<div >this is an async component<div/>'
        })
      }, 3000)
    })
  }))
14. provide/inject
  // 父组件
  const app = Vue.createApp({
    data() {
      return {
        count: 1
      }
    },
    provide() {
      return {
        count: this.count // 向下传递数据，注意 count 不会和 data 中的 count 同步变化！
      }
    }
    template: '<erzi />'
  })
  // 孙子组件
  app.component('sunzi', {
    inject: ['count'],
    template: '<div>{{ count }}</div>'
  })
```
