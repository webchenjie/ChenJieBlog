---
title: 进阶知识
date: 2020-12-13
---

# 计算机网络

```js
// 什么是计算机网络
1. 计算机网络主要由一些通用的、可编程的硬件互连而成
2. 通过这些硬件，可以传送不同类型的数据，并且可以支持广泛和日益增长的应用
3. 计算机网络不是软件概念，还包含硬件设备
4. 计算机网络不仅仅是信息通信，还可以支持广泛的应用
----------------------------------------------------------------------------------------------
// 计算机网络的分类
1. 网络的作用范围
  1. 广域网：WAN 范围在几十到几千公里，区域跨省、跨国
  2. 城域网：MAN 范围在 5KM-50KM，区域在城市间
  3. 局域网：LAN 范围在 1KM以内，区域在地区内
2. 网络的使用者
  1. 公用网络
  2. 专用网络
----------------------------------------------------------------------------------------------
// 计算机网络的发展简史
1. 互联网的发展历史
  1. 单个网络 ARPANET
    1. 交换机
  2. 三级结构互联网
    1. 主干网
    2. 地区网
    3. 校园网
  3. 多层次 ISP 互联网
    1. ISP 即 Internet Service Provider 网络服务提供商如中国电信、中国移动、中国联通等
    2. 主干 ISP // 连接全球
    3. 地区 ISP // 连接地区
    3. 公司、校园、家庭等
2. 中国互联网的发展简史
  1. 1980年开始互联网实验
  2. 1989年第一个公共网络建立运行
  3. 1994年接入国际互联网
  4. 五大公共网络
    1. 中国电信互联网 CHINANET
    2. 中国联通互联网 UNINET
    3. 中国移动互联网 CMNET
    4. 中国教育与科研计算机网 CERNET
    5. 中国科学技术网 CSTNET
----------------------------------------------------------------------------------------------
// 计算机网络的层次结构
1. 层次结构设计的基本原则
  1. 各层之间是相互独立的
  2. 每一层要有足够的灵活性
  3. 各层之间完全解耦
2. OSI 七层模型
  1. 应用层：为计算机用户提供接口和服务
  2. 表示层：数据处理（编码解码、加密解密等）
  3. 会话层：管理（建立、维护、重连）通信会话
  4. 传输层：管理端到端的通信连接
  5. 网络层：数据路由（决定数据在网络的路径）
  6. 数据链路层：管理相邻节点之间的数据通信
  7. 物理层：数据通信的光电物理特性
  8. OSI 最终并没有成为广为使用的标准模型
    1. OSI 欲成为全球计算机都遵循的标准
    2. OSI 在市场化过程中困难重重，TCP/IP 在全球范围成功运行
    3. OSI 的专家缺乏实际经验
    4. OSI 标准制定周期过长，按 OSI 标准生产的设备无法及时进入市场
    5. OSI 模型设计的并不合理，一些功能在多层中重复出现
3. TCP/IP 四层模型
  1. 应用层 // HTTP、FTP
    1. OSI 的应用层
    2. OSI 的表示层
    3. OSI 的会话层
  2. 传输层 // TCP、UDP
    1. OSI 的传输层
  3. 网络层 // IP、ICMP
    1. OSI 的网络层
  4. 网络接口层 // Ethernet、ARP、RARP
    1. OSI 的数据链路层
    2. OSI 的物理层
----------------------------------------------------------------------------------------------
// 网络接口层之现代互联网的网络拓扑
1. 边缘部分
  1. 家庭：多终端机器——>路由器——>网关——>地区 ISP
  2. 企业：多终端机器——>多路由器——>多网关——>地区 ISP
2. 核心部分
  主干 ISP 通过海底电缆连接
3. 用户连接模式
  1. 客户——服务器（C/S）模式
  2. 对等连接（P2P）模式
----------------------------------------------------------------------------------------------
// 网络接口层之计算机网络的性能指标
1. 速率：bps = bit/s
2. 时延
  1. 发送时延 = 数据长度（bit）/ 发送速率（bit/s） // 受限于计算机网卡
  2. 传播时延 = 传输路径距离 / 传播速率（bit/s） // 受限于传输介质 
  3. 排队时延：数据包在网络设备中等待被处理的时间
  4. 处理时延：数据包到达设备或目的机器被处理所需要的时间
  5. 总时延 = 发送时延 + 传播时延 + 排队时延 + 处理时延
3. 往返时间（RTT）
  1. RTT（Route-Trip Time）是评估网络质量的一项重要指标
  2. RTT 表示的是数据报文在端到端通信中的来回一次的时间
  3. 通常使用 ping 命令查看 RTT
----------------------------------------------------------------------------------------------
// 网络接口层之物理层概述
1. 物理层的作用
  1. 连接不同的物理设备
  2. 传输比特流
  3. 传输介质
    1. 双绞线
    2. 同轴电缆
    3. 光纤
    4. 红外线
    5. 无线
    6. 激光
2. 信道的基本概念
  1. 信道是往一个方向传送信息的媒体
  2. 一条通信电路包含一个接收信道和一个发送信道
  3. 单工通信信道
    1. 只能往一个方法通信，没有反方向反馈的信道
    2. 有线电视、无限电收音机等
  4. 半双工通信信道
    1. 双方都可以发送和接收信息
    2. 不能双方同时发送，也不能同时接收
  5. 全双工通信信道
    1. 双方都可以同时发送和接收信息
3. 分用-复用技术
  1. 传送和接收都走同一个入口和出口，而不是都有各自的信道
----------------------------------------------------------------------------------------------
// 网络接口层之数据链路层概述
1. 封装成帧
  1. 帧 是数据链路层数据的基本单位
  2. 发送端在网络层的一段数据前后添加特定标记形成 帧
  3. 接收端根据前后特定标记识别出 帧
  4. 物理层不管 帧
  5. 帧 首部和尾部是特定的控制字符（特定比特流）
  6. SOH：00000001
  7. EOT：00000100
  8. 如果数据中有 SOH 和 EOT 会在前面加上 ESC 作为转义
2. 透明传输
  1. 透明在计算机领域是非常重要的一个术语
  2. 一种实际存在的事物却又看起来不存在一样
  3. 即是控制字符在帧数据中，但是要当做不存在的去处理
3. 差错监测
  1. 物理层只管传输比特流，无法控制是否出错
  2. 数据链路层负责起 差错监测 功能
  3. 奇偶校验码
  4. 循环冗余校验码 CRC
----------------------------------------------------------------------------------------------
// 网络接口层之最大传输单元 MTU
1. MTU
  1. 最大传输单元 MTU （Maximum Transmission Unit）
  2. 数据链路层的数据帧也不是无限大的
  3. 数据帧过大或过小都会影响传输的效率
  4. 以太网 MTU 一般为 1500 字节
2. 路径 MTU
  1. 路径 MTU 由链路中 MTU 的最小值决定
----------------------------------------------------------------------------------------------
// 网络接口层之以太网协议详解
1. MAC 地址
  1. MAC 地址（物理地址、硬件地址）
  2. 每一个设备都拥有唯一的 MAC 地址
  3. MAC 地址共48位，使用十六进制表示
  4. cmd ——> piconfig/all // 查看 MAC 地址
2. 以太网协议
  1. 以太网（Ethernet）是一种使用广泛的局域网技术
  2. 以太网是一种应用于数据链路层的协议
  3. 使用以太网可以完成相邻设备的数据帧传输
  4. 路由器拥有一张 MAC 地址表，用于识别发送的目的机器
3. 数据发送流程
  1. A 通过网卡发出数据帧
  2. 数据帧到达路由器，路由器取出前6字节即目的机器的 MAC 地址
  3. 路由器匹配 MAC 地址表，找到对应的网络接口
  4. 路由器往该网络接口发送数据帧
  5. 如果匹配不到 MAC 地址表，则会广播发送给所有在表中的机器，收到回应后，会记录下未知匹配不到的 MAC 地址表
----------------------------------------------------------------------------------------------
// 网络层之IP 协议详解
1. 虚拟互连网络
  1. 实际的计算机网络是错综复杂的
  2. 物理设备通过使用 IP 协议，屏蔽了物理网络之间的差异
  3. 当网络中的主机使用 IP 协议连接时，则无需关注网络细节
  4. IP 协议使得复杂的实际网络变为一个虚拟互连的网络
  5. IP 协议使得网络层可以屏蔽底层细节而专注网络层的数据转发
  6. IP 协议解决了再虚拟网络中数据报传输路径的问题
2. IP 协议 // 一共有 2^32 = 4294961296 个 IP
  1. IP 地址长度为32位，常分成4个8位的二进制数
  2. IP 地址常使用点分十进制来表示 // 0~255.0~255.0~255.0~255
----------------------------------------------------------------------------------------------
// 网络层之 IP 协议的转发流程
1. 路由表简介
  1. 计算机或者路由器都拥有路由表
  2. 路由表包含了目的 IP 地址和下一跳的 IP 地址
2. IP 协议的转发流程
  1. 数据帧每一跳的 MAC 地址都在变化
  2. IP 数据报每一跳的 IP 地址始终不变
  3. 网络层的转发流程
    1. A 发出目的地为 C 的 IP 数据报，查询路由表发现下一跳为 E
    2. A 将数据报发送给 E
    3. E 查询路由表发现下一跳为 F，将数据报发送给 F
    4. F 查询路由表发现目的地 C 直接连接，将数据报发送给 C
  4. 数据链路层 + 网络层的转发流程
    1. A 发出目的地为 C 的 IP 数据报，查询路由表发现下一跳为 E
    2. A 将 IP 数据报交给数据链路层，并告知目的 MAC 地址是 E // 查询 ARP 缓存表
    3. 数据链路层填充源 MAC 地址 A 和目的 MAC 地址 E
    4. 数据链路层通过物理层将数据发送给 E
    5. E 的数据链路层接收到数据帧，把帧数据交给网络层
    6. E 查询路由表，发现下一跳为 F
    7. E 把数据报交给数据链路层，并告知目的 MAC 地址为 F // 查询 ARP 缓存表
    8. E 的数据链路层封装数据帧并发送
    9. F 的数据链路层接收到数据帧，把帧数据交给网络层
    10. F 查询路由表，发现下一跳为 C
    11. F 把数据报交给数据链路层，并告知目的 MAC 地址为 C // 查询 ARP 缓存表
    12. F 的数据链路层封装数据帧并发送
----------------------------------------------------------------------------------------------
// 网络层之 ARP 协议与 RARP 协议
1. ARP （Address Resolution Protocol）地址解析协议 // cmd arp -a
  1. 用于将网络层 IP 32位地址转换成数据链路层 MAC 48位地址
  2. ARP 缓存表就是 IP 地址和 MAC 地址的映射
  3. ARP 缓存表是 ARP 协议和 RARP 协议运行的关键
  4. ARP 缓存表缓存了 IP 地址到硬件地址之间的映射关系
  5. ARP 缓存表中的记录并不是永久有效的，有一定的期限
2. RARP （Reverse Address Resolution Protocol）逆地址解析协议
  1. 用于将数据链路层 MAC 48位地址转换成网络层 IP 32位地址
----------------------------------------------------------------------------------------------
// IP 地址的子网划分
1. 分类的 IP 地址
  1. IP 分为网络号和主机号
  2. A类地址：网络号有8位且以0开头，主机号有24位
    1. 最小网络号：1
    2. 最大网络号：127（01111111）
    3. 子网数量：2^7-2
    4. 最小主机号：0.0.1
    5. 最大主机号：255.255.254
    6. 主机数量：2^24-2
  3. B类地址：网络号有16位且以10开头，主机号有16位
    1. 最小网络号：128.1
    2. 最大网络号：191.255
    3. 子网数量：2^14-1
    4. 最小主机号：0.1
    5. 最大主机号：255.254
    6. 主机数量：2^16-2
  4. C类地址：网络号有24位且以110开头，主机号有8位
    1. 最小网络号：192.0.1
    2. 最大网络号：223.255.255
    3. 子网数量：2^21-1
    4. 最小主机号：1
    5. 最大主机号：254
    6. 主机数量：2^8-2
  5. D类地址：以1110开头
  6. E类地址：以1111开头
  7. 特殊的主机号
    1. 主机号全0表示当前网络段，不可分配给特定主机 // 1.2.3.4
    2. 主机号为全1表示广播地址，向当前网络段所有主机 发消息 // 1.255.255.255
  8. 特殊的网络号
    1. A类地址网络段全（000000000）表示特殊网络
    2. A类地址网络段后7位全1（01111111即127）表示回环地址
    3. B类地址网络段（10000000.00000000即128.0）是不可使用的
    4. C类地址网络段（192.0.0）是不可使用的
  9. 127.0.0.1 通常称为本地回环地址（Loopback Address）
    1. 不属于任何一个有类别地址类，它代表设备的本地虚拟接口，所以默认被看做是永远不会宕掉的接口
    2. 在 windows 操作系统中也有相似的定义，所以通常在安装网卡前就可以 ping 通这个本地回环地址
    3. 一般都会用来检查本地网络协议、基本数据接口等是否正常
2. 划分子网
  1. IP 地址划分为网络号、子网号、主机号
  2. 193.10.10.0 可以划分为 193.10.10.0 ~ 193.10.10.127 和 193.10.10.128 ~ 193.10.10.255
  3. 子网掩码 // 用于判断 ip 是属于哪个网络号
    1. 子网掩码和 IP 地址一样，都是 32 位
    2. 子网掩码由连续的 1 和连续的 0 组成
    3. 某一个子网的子网掩码具备网络号位数个连续的 1
    4. A 类地址的子网掩码：255.0.0.0
    5. B 类地址的子网掩码：255.255.0.0
    6. C 类地址的子网掩码：255.255.255.0
    7. 子网掩码如何换算成子网号
      1. 把子网掩码和 IP 地址都先换算成二进制
      2. 再把两个二进制进行与运算，就是两个都是1就是1，不同就是0
      3. 再把与运算的结果换算成十进制即可得到网络号
3. 无分类编址 CIDR
  1. CIDR 中没有 A、B、C 类网络号和子网划分的概念
  2. CIDR 将网络前缀相同的 IP 地址称为一个 CIDR 地址块
  3. 在 CIDR 中的 IP 地址分为网络前缀和主机号
  4. 网络前缀是任意位数的
  5. 相比原来子网划分更加灵活
```