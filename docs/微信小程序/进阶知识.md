---
title: 微信小程序
date: 2020-07-11
---

``` js
// 登录,获取用户信息
1. wx.login // 不需要授权,静默登录,登录状态有时效性,多久失效由微信服务器决定
2. wx.openSetting() // 用户全部的授权记录,让用户重新授权
3. wx.getUserInfo
    获取用户信息(明文、加密),需要用户授权
    有wichCredentials参数,如果为true时,必须要求用户已登录否则拿不到信息
    为false时,不需要登录,但拿不到加密信息,如果授权被拒绝则不会再显示触发授权
    如果要重新触发则需调用wx.openSetting()
4. uniID需要授权后拿到,openID不用,在微信公众平台下,openID不一样,uniID一样
5. 在新版的小程序中要想让用户授权必须使用button让用户点击引导授权
   通过wx.getSetting判断用户是否授权,如果用户已经授权,可以调用getUserInfo获取用户信息,没授权则获取不到
6. 在使用授权button时<button open-type="getUserInfo" bind:getUserInfo="方法名"> // 通过方法名的event拿到用户信息
7. 内置组件<open-data>这个可以获取用户信息,只在wxml中有用
----------------------------------------------------------------------------------------------
// 组件
1. 使用组件时需要在使用的页面的json中配置引入:
    "usingComponents": { '组件名': '组件目录' }
    即可在wxml中使用<组件名></组件名>
2. 组件只能继承全局文件的font/color的css
3. 小程序子组件向父组件传值时的this.triggerEvent与vue的this.$emit一样
4. 不要在properties的observer中修改自身的值,会触发无限递归 // this.properties.数据名, observer相当于vue的watch
5. 小程序自定义组件的扩展behavior是组件中js的抽象,把组件中相同的东西提取到一个behavior中,使用与自定义组件一样
   需要组件导入、注册,在属性方面,组件中与behavior发生重名时会覆盖,写在behavior后面(多个)会覆盖前面的
   而生命周期不会覆盖,会依次执行
6. 在properties中绑定的数据在wxml中可以直接用属性的方式在组件中使用
7. 组件的生命周期:
    created() // 渲染前
    attached() // 渲染时
    ready() // 渲染后
    mored() // 组件移动时
    datached() // 组件删除时
8. 在组件中的this.data和this.properties指的是同一个js对象
9. 自定义组件不支持hidden属性,如要实现则在组件的properties中添加hidden属性,然后在组件的wxml中绑定属性
10. 组件中只进行自身的逻辑,关于其他的业务则放在调用方进行 // 粒度
11. 在小程序的组件中使用插槽slot和vue中一样,但需要在组件的js中的component下新增options: { multipleslots: true }才能使用
12. 不能对自定义名字的组件进行css修饰无效,可以对自定义组件下的某一个标签修饰
13. 组件的css可以通过小程序的外部样式来改变内部样式
    在component下新增extermalclasses: ['样式名'],然后把样式名加在需要应用的标签上
    在外部的页面中的组件名上增加 样式名="自定义样式名",一个是内部样式名,一个是外部样式名
    需要加!important,也可提升优先级的其他方法,默认不确定外部会覆盖内部
14. 小程序的{{}}只能写简单的js表达式,而不能调用方法
15. wxs可以在wxml中调用js和es6的js不一样
    在wxml中通过<wxs src="wxs文件的路径" module="自定义名字">
    在wxml中通过自定义名字.函数名调用
    在wxs中通过module.export = { 函数名 }导出
    也可直接在wxs中嵌入wxs代码<wxs module="自定义">内容</wxs>
16. 组件也可以引用组件、方法和页面引用组件一样
----------------------------------------------------------------------------------------------
1. 在js拿到数据后通过setData绑定到data中,即可在wxml中使用
2. wx:key的取值为不重复的数字或字符串,如果遍历下的列表是数字或字符串,可以wx:key = "*this" // *this
3. 通过锁的概念解决重复加载数据的问题,在加载前定义一个flg变量进行判断,进行中不执行加载代码
4. this.setData和this.data.名字,如果数据在wxml中有应用绑定则使用this.setData,如果没有可以使用this.data.名字 // 在组件中
5. 可以使用图片按钮让按钮自定义样式
6. 公众号分为服务号和订阅号
7. 如果要从一个小程序跳转到另一个小程序,两个小程序必须绑定同一个公众号
8. 在小程序中使用npm后,然后再点击工具栏的npm构建才能导入使用
```