(window.webpackJsonp=window.webpackJsonp||[]).push([[63],{490:function(t,a,s){"use strict";s.r(a);var e=s(2),r=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"简述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#简述"}},[t._v("#")]),t._v(" 简述")]),t._v(" "),a("h3",{attrs:{id:"webrtc-简述"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webrtc-简述"}},[t._v("#")]),t._v(" WebRTC 简述")]),t._v(" "),a("ul",[a("li",[t._v("音视频处理 + 即时通讯的开源库")]),t._v(" "),a("li",[t._v("2010 年 Google 将其开源")]),t._v(" "),a("li",[t._v("它是一个非常优秀的多媒体框架，主要用于浏览器，并且是跨平台")]),t._v(" "),a("li",[t._v("与 ffmpeg 类似，但是侧重点不一样，ffmpeg 主要是处理多媒体文件的编译、音视频的编解码、对文件的处理等，而 WebRTC 主要是处理网络的抖动、丢包、评估、回音消除、降噪等")])]),t._v(" "),a("h3",{attrs:{id:"webrtc-能做啥"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webrtc-能做啥"}},[t._v("#")]),t._v(" WebRTC 能做啥？")]),t._v(" "),a("ul",[a("li",[t._v("音视频实时互动")]),t._v(" "),a("li",[t._v("游戏、即时通讯、文件传输等")]),t._v(" "),a("li",[t._v("它是一个百宝箱，传输、音视频处理（回音消除、降噪等）")])]),t._v(" "),a("h3",{attrs:{id:"主要内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主要内容"}},[t._v("#")]),t._v(" 主要内容")]),t._v(" "),a("ul",[a("li",[t._v("音视频设备访问与管理")]),t._v(" "),a("li",[t._v("音视频数据的采集")]),t._v(" "),a("li",[t._v("数据的传输与实时互动")]),t._v(" "),a("li",[t._v("WebRTC 的工作机制")])]),t._v(" "),a("h2",{attrs:{id:"设备管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#设备管理"}},[t._v("#")]),t._v(" 设备管理")]),t._v(" "),a("ul",[a("li",[t._v("navigator.mediaDevices.enumerateDevices()")]),t._v(" "),a("li",[t._v("在调用此方法前，需要用户授权允许，浏览器会弹窗提示，但是直接调用此方法并不会触发弹窗，需要调用 getUserMedia 才会，也就是说可以先调用 getUserMedia，然后授权后，再调用此方法就能获取到对应的设备，当然有些浏览器不需要授权就可以直接调用成功，如 Chrome，而 Safari 则需要")])]),t._v(" "),a("h2",{attrs:{id:"音视频数据的采集"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#音视频数据的采集"}},[t._v("#")]),t._v(" 音视频数据的采集")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("navigator.mediaDevices.getUserMedia({ video: true, audio: true })")])]),t._v(" "),a("li",[a("p",[t._v("video 和 audio 的类型除了可以是 boolean 外，还可以是一个对象")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("video")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("width")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("height")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("aspectRatio")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 宽高的比例")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("frameRate")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 帧率")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("facingMode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'user'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'environment'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'left'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'right'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 使用哪个摄像头")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("resizeMode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" string "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 裁剪")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("audio")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("volume")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 音量")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sampleRate")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 采样率")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sampleSize")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 采样大小，位深")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("echoCancellation")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" boolean "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否开启回音消除")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("autoGainControl")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" boolean "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 增加音量")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("noiseSuppression")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" boolean "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 是否开启降噪功能")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("latency")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 延迟大小")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("channelCount")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 声道数")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("deviceID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 设备ID，当有多个设备进行切换时使用，通过上面的 enumerateDevices 获取")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("groupID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" number "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 物理设备")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br")])])]),t._v(" "),a("li",[a("p",[t._v("getUserMedia 返回流相关的 API")]),t._v(" "),a("ul",[a("li",[t._v("MediaStream.addTrack() // 增加轨")]),t._v(" "),a("li",[t._v("MediaStream.removeTrack() // 删除轨")]),t._v(" "),a("li",[t._v("MediaStream.getVideoTracks() // 获取所有的视频轨")]),t._v(" "),a("li",[t._v("MediaStream.getAudioTracks() // 获取所有的音频轨")]),t._v(" "),a("li",[t._v("MediaStream.onaddtrack // 增加轨时触发")]),t._v(" "),a("li",[t._v("MediaStream.onremovetrack // 删除轨时触发")]),t._v(" "),a("li",[t._v("MediaStream.onended // 结束时触发")])])])]),t._v(" "),a("h2",{attrs:{id:"浏览器适配"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器适配"}},[t._v("#")]),t._v(" 浏览器适配")]),t._v(" "),a("ul",[a("li",[t._v("adapter.js 主要是对 API 做兼容，增加了如 webkit、moz 等前缀")])]),t._v(" "),a("h2",{attrs:{id:"浏览器视频特效"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浏览器视频特效"}},[t._v("#")]),t._v(" 浏览器视频特效")]),t._v(" "),a("ul",[a("li",[t._v("使用 CSS filter ==> 底层调用的是 OpenGL")]),t._v(" "),a("li",[t._v("支持的特效种类\n"),a("ul",[a("li",[t._v("grayscale 灰度")]),t._v(" "),a("li",[t._v("sepia 褐色")]),t._v(" "),a("li",[t._v("saturate 饱和度")]),t._v(" "),a("li",[t._v("hue-rotate 色相旋转")]),t._v(" "),a("li",[t._v("invert 反色")]),t._v(" "),a("li",[t._v("opacity 透明度")]),t._v(" "),a("li",[t._v("brightness 亮度")]),t._v(" "),a("li",[t._v("contrast 对比度")]),t._v(" "),a("li",[t._v("blur 模糊")]),t._v(" "),a("li",[t._v("drop-shadow 阴影")])])]),t._v(" "),a("li",[t._v("在 video 播放的时候，可以使用 canvas.drawImage(video) 进行截图，截图中可以含有 filter 的效果，但是实际保存到本地的图片并没有此效果")])]),t._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"title"}),a("p",[t._v("作者：chenjie "),a("br"),t._v("\n链接：https://webchenjie.cn "),a("br"),t._v("\n来源：ChenJieBlog")])])])}),[],!1,null,null,null);a.default=r.exports}}]);